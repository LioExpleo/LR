{% extends 'base.html' %}
{% load static %}
{% block content %}
<form method="post" enctype="multipart/form-data">

<style> p {color: black;}
  clPostReview {color: blue;}
  clPostTicketSansReview {position: relative; top: 30px; left: 160px;
                                                            width: 200px; border: 2px solid blue;
                                                            text-align: center; width:400px;height:550px;
                        padding-top:20px; padding-right:20px; padding-bottom:20px; padding-left:100px}
 </style>

<!--
    <p> <h4>Liste des tickets dans le Review de l'utilisateur : listTicketInReviews_user :  {{ listTicketInReviews_user }} </h4>  </p>
    <p> <h4>Liste des tickets utilisateurs : listTicketInTicket_user :  {{ listTicketInTicket_user }} </h4>  </p>
    <p> <h4>Liste des tickets de l'utilisateur sans Review : listTicketWithoutReviews_user :  {{ listTicketWithoutReviews_user }} </h4>  </p>

    <p> la liste listTicketWithoutReviews_user, indique quel tickets seront à afficher sans Review </p>
-->

{% for instance in tickets_and_reviews %} <!-- boucle 1 pour tester tous les Reviews et tickets -->
     {% for instReview in reviews_user %} <!-- boucle 1.1 pour tester tous les Reviews de l'utilisateur -->
        {% if instance.id == instReview.id %}

        <div class="cl_divP1" style="  position: relative; top: 15px; left: 0px; right: 0px;
                                                            width: 200px; border: 4px solid purple;
                                                            text-align: left; width:950px;height:925px;
                        padding-top:0px; padding-right:80px; padding-bottom:0px; padding-left:0px">

            <p><h2/>Vous avez publié une critique  (référence {{ instReview.id }}){{ instReview.time_created }}</h2></p>

            <p> ticket : {{ instReview.ticket.id }}</p>
            <p> rating : {{ instReview.rating }}</p>

            {% include "extrait/extr_rating_stars2.html" with rating=instReview.rating list_for_max_star=list_for_max_star%}
            <p> headline : {{ instReview.headline }}</p>
            <p> body : {{ instReview.body }}</p>
            <p> <h4> n° TICKET REVIEW : {{ instReview.ticket.id }}</p> </h4>

            {% for instTicketOther in tickets_other_user %}
            <!-- <p> TICKET AUTRE UTILISATEUR : {{ instTicketOther.id }}</p> -->
            <!-- si le ticket du review = l'id du ticket de l'utilisateur, afficher les données de l'autre utilisateur
            à la suite-->
                {% if instReview.ticket.id == instTicketOther.id %}
                    <div class="cl_divP1_1" style="  position: relative; top: 0px; left: 50px;right:50px;
                                                            width: 200px; border: 2px solid green;
                                                            text-align: left; width:800px;height:570px;
                        padding-top:0px; padding-right:0px; padding-bottom:60px; padding-left:100px">
                    <br>
                    <p> REVIEW avec TICKET AUTRE UTILISATEUR n° ticket : {{ instReview.ticket.id }}</p>
                    <p> <h4> instTicket.id :  {{ instTicketOther.id }} </h4>  </p>
                    <p> instTicket.user :  {{ instTicketOther.user }}   </p>
                    <p> Identifiant Unique : {{ instTicketOther.id }}</p>
                    <p> Titre Ticket : {{ instTicketOther.title }}</p>
                    <p> Description Ticket : {{ instTicketOther.title }}</p>

                    {% if instTicketOther.image.url is not None %}
                        <img src="{{ instTicketOther.image.url }}" width="200" height="300">
                    {% else %}
                             <img src="{% static 'img/NoImgOtherUser.gif' %}"  alt="Etoile" width="200" height="300">
                    {% endif %}
                    <br>
                    <br>
                    <br>
                    <a href="{% url 'review_update' instReview.id %}">[Modifier Review]</a>
                    <a href="{% url 'review_delete' instReview.id %}">[Supprimer Review]</a>

                    </div>
                    <br>

                {% endif %}
             {% endfor %}

     <!-- Les critiques qui sont affichées en réponse au ticket de l'utilisateur lui-même doivent être
     listées séparément du ticket ensuite-->
             {% for instTicket in tickets_user %}
                 <!-- <p> instTicket.id : {{ instTicket.id }}</p>-->
                {% if instReview.ticket.id == instTicket.id %}

                        <div class="cl_divP1_2" style="  position: relative; top: 0px; left: 50px;right:50px;
                                                            width: 200px; border: 2px solid pink;
                                                            text-align: left; width:800px;height:560px;
                        padding-top:0px; padding-right:0px; padding-bottom:0px; padding-left:100px">
                            <p> <h4> Vous avez publié un ticket que vous avez vous-même critiqué {{ instTicket.id }}</h4>  </p>
                        <p> <h4>instTicket.id :  {{ instTicket.id }} </h4>  </p>
                        <p> instTicket.user :  {{ instTicket.user }}  </p>
                        <p> Identifiant Unique : {{ instTicket.id }}</p>
                        <p> Titre Ticket : {{ instTicket.title }}</p>
                        <p> Description Ticket : {{ instTicket.title }}</p>

                        {% if instTicket.image.url is not None %}
                            <img src="{{ instTicket.image.url }}" width="200" height="300">
                        {% else %}
                             <img src="{% static 'img/NoImg.gif' %}"  alt="Etoile" width="200" height="300">
                        {% endif %}
                    <br><br><br><br><br><br>
                    <a href="{% url 'review_update' instReview.id %}">[Modifier Review]</a>
                    <a href="{% url 'review_delete' instReview.id %}">[Supprimer Review]</a>
                    <br>
                        </div>
            </div>
            <br>
                {% endif %}
            {% endfor %}
            {% endif %}
        {% endfor %}

        <!-- Affichage des tickets de l'utilisateur sans Review de l'utilisateur   -->
       {% for i in listTicketWithoutReviews_user %} <!-- boucle 1.2 pour tester tous les tickets sans Review user -->
              {% if instance.id == i %}
                {% for instTicket in tickets_user %} <!-- boucle 1.2.1 pour tester tous les tickets user -->
                    {% if instance.id == instTicket.id %}
                        <div class="cl_divP2" style="  position: relative; top: 0px; left: 0px;right:50px;
                                                            width: 200px; border: 2px solid black;
                                                            text-align: left; width:930px;height:510px;
                        padding-top:0px; padding-right:0px; padding-bottom:0px; padding-left:100px">

                        <p> <h4> Vous avez publié un ticket (sans sa propre critique) {{ instTicket.id }}</h4>  </p>
                        <p>{{ instTicket.time_created  }}</p>
                        <p> Titre {{ instTicket.title }}</p>
                        <p>{{ instTicket.description }}</p>
                        {% if instTicket.image.url is not None %}
                            <img src="{{ instTicket.image.url }}" width="200" height="300">
                        {% else %}
                             <img src="{% static 'img/NoImg.gif' %}"  alt="Etoile" width="200" height="300">
                        {% endif %}
                        <br>
                        <a href="{% url 'ticket_update' instTicket.id %}">[Modifier ticket]</a>
                        <a href="{% url 'ticket_delete' instTicket.id %}">[Supprimer ticket]</a>
                        </div>
                        <br>

                    {% endif %}
                {% endfor %}
              {% endif %}
       {% endfor %}

        <!-- Affichage des tickets de l'utilisateur en dehors des Review utilisateur   -->
     {% for instTicket in tickets_user %}
        {% if instance.id == instTicket.id %}
            {% if instTicket.id in listTicketReviewsEvenUser %}
                        <br>
                        <div class="cl_divP2" style="  position: relative; top: 0px; left: 0px;
                                                            width: 200px; border: 5px solid IndianRed ;
                                                            text-align: left; width:1030px;height:620px;
                        padding-top:0px; padding-right:0px; padding-bottom:0px; padding-left:0px" >

                             <p> <h4> listTicketReviewsEvenUser :  {{ listTicketReviewsEvenUser }}   </p>

                        <p>  listTicketWithoutReviews_user.user :  {{ listTicketWithoutReviews_user }} </p>
                        <p> <h4> Vous avez publié un ticket (sans sa propre critique) {{ instTicket.id }}</h4>  </p>
                        <p> <h4> Vous avez publié un ticket {{ instTicket.id }}</h4>  </p>
                        <p>{{ instTicket.time_created  }}</p>
                        <p> Titre {{ instTicket.title }}</p>
                        <p>{{ instTicket.description }}</p>
                        {% if instTicket.image.url is not None %}
                            <img src="{{ instTicket.image.url }}" width="200" height="300">
                        {% else %}
                             <img src="{% static 'img/NoImg.gif' %}"  alt="Etoile" width="200" height="300">
                        {% endif %}
                        <br>
                        <a href="{% url 'ticket_update' instTicket.id %}">[Modifier ticket]</a>
                        <a href="{% url 'ticket_delete' instTicket.id %}">[Supprimer ticket]</a>
                        </div>
            {% endif %}
        {% endif %}
     {% endfor %}

{% endfor %}
</form>
{% endblock %}


